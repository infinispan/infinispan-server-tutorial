<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Infinispan Remote Weather App Tutorial</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #408080; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #FF0000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
pre.pygments .tok-go { color: #888888 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #7D9029 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #A0A000 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_infinispan_remote_weather_app_tutorial">Infinispan Remote Weather App Tutorial</a>
<ul class="sectlevel2">
<li><a href="#_objectives">Objectives</a></li>
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_weather_system_architecture">Weather System Architecture</a>
<ul class="sectlevel3">
<li><a href="#_temperature_subsystem">Temperature Subsystem</a>
<ul class="sectlevel4">
<li><a href="#_temperature_loader">Temperature Loader</a></li>
<li><a href="#_temperature_monitor">Temperature Monitor</a></li>
</ul>
</li>
<li><a href="#_weather_subsystem">Weather Subsystem</a>
<ul class="sectlevel4">
<li><a href="#_weather_loader">Weather Loader</a></li>
<li><a href="#_weather_finder">Weather Finder</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_starting_infinispan_server">Starting Infinispan Server</a>
<ul class="sectlevel3">
<li><a href="#_running_the_container_image">Running the Container Image</a></li>
<li><a href="#_running_the_server_distribution">Running the Server Distribution</a></li>
</ul>
</li>
<li><a href="#_accessing_the_infinispan_console">Accessing the Infinispan Console</a></li>
<li><a href="#_getting_the_weather_application">Getting the Weather Application</a></li>
<li><a href="#_establishing_remote_connections">Establishing Remote Connections</a>
<ul class="sectlevel3">
<li><a href="#_add_dependencies">Add Dependencies</a></li>
<li><a href="#_create_a_remote_connection">Create a Remote Connection</a></li>
<li><a href="#_test_the_connection">Test the Connection</a></li>
</ul>
</li>
<li><a href="#_implementing_temperature_loader">Implementing Temperature Loader</a>
<ul class="sectlevel3">
<li><a href="#_create_a_temperature_cache">Create a Temperature Cache</a></li>
<li><a href="#_put_and_read_temperature_data">Put and Read Temperature Data</a></li>
<li><a href="#_verify_temperature_loader">Verify Temperature Loader</a></li>
<li><a href="#_expiring_data">Expiring Data</a></li>
</ul>
</li>
<li><a href="#_implementing_temperature_monitor">Implementing Temperature Monitor</a>
<ul class="sectlevel3">
<li><a href="#_create_a_client_listener">Create a Client Listener</a></li>
<li><a href="#_verify_temperature_monitor">Verify Temperature Monitor</a></li>
</ul>
</li>
<li><a href="#_implementing_weather_loader">Implementing Weather Loader</a>
<ul class="sectlevel3">
<li><a href="#_annotate_the_locationweather_pojo">Annotate the LocationWeather POJO</a></li>
<li><a href="#_configure_the_serialization_context">Configure the Serialization Context</a></li>
<li><a href="#_create_a_weather_cache">Create a Weather Cache</a></li>
<li><a href="#_verify_weather_loader">Verify Weather Loader</a></li>
</ul>
</li>
<li><a href="#_implementing_weather_finder">Implementing Weather Finder</a>
<ul class="sectlevel3">
<li><a href="#_create_a_from_query">Create a FROM Query</a></li>
<li><a href="#_run_the_from_query">Run the FROM Query</a></li>
<li><a href="#_create_a_select_query">Create a SELECT Query</a></li>
<li><a href="#_run_the_select_query">Run the SELECT Query</a></li>
<li><a href="#_create_a_continuous_query">Create a Continuous Query</a></li>
<li><a href="#_run_the_continuous_query">Run the Continuous Query</a></li>
</ul>
</li>
<li><a href="#_testing_infinispan_server">Testing Infinispan Server</a>
<ul class="sectlevel3">
<li><a href="#_add_dependencies_2">Add Dependencies</a></li>
<li><a href="#_using_test_containers">Using Test Containers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_whats_next">What&#8217;s Next?</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="imageblock">
<div class="content">
<img src="./images/infinispan_logo.svg" alt="Infinispan Logo">
</div>
</div>
<div class="sect1">
<h2 id="_infinispan_remote_weather_app_tutorial">Infinispan Remote Weather App Tutorial</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Learn how to use Infinispan from the Console and remote Hot Rod clients. This
tutorial includes Java applications that use Infinispan capabilities to provide
services for a searchable weather monitoring system.</p>
</div>
<div class="sect2">
<h3 id="_objectives">Objectives</h3>
<div class="paragraph">
<p>By completing this tutorial, you will learn how to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run Infinispan Server.</p>
</li>
<li>
<p>Access and use the Infinispan Console.</p>
</li>
<li>
<p>Create Infinispan caches.</p>
</li>
<li>
<p>Read and write data as primitive types and Java objects.</p>
</li>
<li>
<p>Add lifespans to entries so data expires.</p>
</li>
<li>
<p>Deploy client listeners to get event notifications.</p>
</li>
<li>
<p>Search the data store for specific values.</p>
</li>
<li>
<p>Use out-of-the-box testing with Junit 5 for verification.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_prerequisites">Prerequisites</h3>
<div class="paragraph">
<p>To complete this tutorial, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Approximately 25 to 30 minutes</p>
</li>
<li>
<p>IDE such as Eclipse or Intellij</p>
</li>
<li>
<p>JDK 11 or later</p>
</li>
<li>
<p><a href="https://www.docker.com/">Docker</a> or <a href="https://podman.io/">Podman</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Run <code>mvn --version</code> to verify that Maven uses the correct JDK if you have
multiple Java versions installed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_weather_system_architecture">Weather System Architecture</h3>
<div class="paragraph">
<p>This tutorial builds a Weather System with the following Java applications:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>TemperatureLoaderApp</code></p>
</li>
<li>
<p><code>TemperatureMonitorApp</code></p>
</li>
<li>
<p><code>WeatherLoaderApp</code></p>
</li>
<li>
<p><code>WeatherFinderApp</code></p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_temperature_subsystem">Temperature Subsystem</h4>
<div class="paragraph">
<p>The Temperature Loader and Temperature Monitor applications comprise the temperature subsystem, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/Temperature.png" alt="Temperature.png">
</div>
</div>
<div class="sect4">
<h5 id="_temperature_loader">Temperature Loader</h5>
<div class="paragraph">
<p>This application loads temperatures for geographic locations and runs every five seconds. Infinispan stores that data in the <code>temperature</code> cache as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Location: Key <code>String</code></p>
</li>
<li>
<p>Temperature: Value <code>Float</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_temperature_monitor">Temperature Monitor</h5>
<div class="paragraph">
<p>This application monitors the temperature of each location. Infinispan sends notifications when temperatures change and the application displays each new temperature.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_weather_subsystem">Weather Subsystem</h4>
<div class="paragraph">
<p>The Weather Loader and Weather Finder applications comprise the weather  subsystem, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/Weather.png" alt="Weather.png">
</div>
</div>
<div class="sect4">
<h5 id="_weather_loader">Weather Loader</h5>
<div class="paragraph">
<p>This application loads weather information for geographic locations and runs every five seconds. Infinispan stores that data in the <code>weather</code> cache as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Location: Key <code>String</code></p>
</li>
<li>
<p>Weather: Value <code>LocationWeather</code> (temperature, condition, city, country)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_weather_finder">Weather Finder</h5>
<div class="paragraph">
<p>This application uses Infinispan Search capabilities to perform text search and continuous queries.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_starting_infinispan_server">Starting Infinispan Server</h3>
<div class="paragraph">
<p>Before you start coding fun stuff, you need to start Infinispan Server. For
this tutorial, you need a locally running server instance.</p>
</div>
<div class="paragraph">
<p>You can do one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pull the container image and run with <a href="https://www.docker.com/">Docker</a> or <a href="https://podman.io/">Podman</a>.</p>
</li>
<li>
<p>Download the server distribution and extract it to your filesystem.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Credentials</div>
<p>By default, Infinispan Server requires user authentication. This tutorial uses
<code>admin</code> and <code>secret</code> credentials but you can use any username and password.</p>
</div>
<div class="sect3">
<h4 id="_running_the_container_image">Running the Container Image</h4>
<div class="paragraph">
<p>The easiest way to run Infinispan Server locally is to pull the container image.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Podman</p>
<div class="paragraph">
<p><code>podman run --net=host -p 11222:11222 -e USER="admin" -e PASS="secret" quay.io/infinispan/server:latest</code></p>
</div>
</li>
<li>
<p>Docker</p>
<div class="paragraph">
<p><code>docker run -it -p 11222:11222 -e USER="admin" -e PASS="password" infinispan/server:latest</code></p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_server_distribution">Running the Server Distribution</h4>
<div class="paragraph">
<p>Infinispan Server comes as a bare metal distribution that you can run locally.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the server distribution from <a href="https://infinispan.org/download/#stable">Infinispan Downloads</a> and extract it.</p>
</li>
<li>
<p>Open a terminal window in the resulting directory. This is <code>$ISPN_HOME</code>.</p>
</li>
<li>
<p>Add credentials.</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="bash"><span></span>$ ./bin/cli.sh user create admin -p secret</code></pre>
</div>
</div>
</li>
<li>
<p>Run Infinispan Server.</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="bash"><span></span>$ ./bin/server.sh</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_the_infinispan_console">Accessing the Infinispan Console</h3>
<div class="paragraph">
<p>Open <a href="http://localhost:11222/">http://localhost:11222/</a> in any browser.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll see the <strong>Welcome to Infinispan Server</strong> page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/welcomeConsole.png" alt="Welcome to the console">
</div>
</div>
<div class="paragraph">
<p>To start using the Infinispan Console, do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select <strong>Go to the console</strong>.</p>
</li>
<li>
<p>Enter your credentials (<code>admin</code>/<code>secret</code>).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_getting_the_weather_application">Getting the Weather Application</h3>
<div class="paragraph">
<p>You can create the Weather Application yourself going step by step or you can skip ahead and use the complete solution.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bootstrap the project.</p>
<div class="paragraph">
<p>You&#8217;ll find the code for each application and placeholder comments for each step in this tutorial on the <code>main</code> branch.</p>
</div>
<div class="paragraph">
<p><code>git clone -b main <a href="https://github.com/infinispan/infinispan-server-tutorial.git" class="bare">https://github.com/infinispan/infinispan-server-tutorial.git</a></code></p>
</div>
</li>
<li>
<p>Use the complete solution.</p>
<div class="paragraph">
<p>If you just want to see the Weather System in action, use the completed example on the <code>solution</code> branch.</p>
</div>
<div class="paragraph">
<p><code>git clone -b solution <a href="https://github.com/infinispan/infinispan-server-tutorial.git" class="bare">https://github.com/infinispan/infinispan-server-tutorial.git</a></code></p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_establishing_remote_connections">Establishing Remote Connections</h3>
<div class="paragraph">
<p>Connect to your locally running Infinispan Server from a Hot Rod Java client.</p>
</div>
<div class="sect3">
<h4 id="_add_dependencies">Add Dependencies</h4>
<div class="paragraph">
<p>Open the <code>pom.xml</code> file for this project and confirm that the following dependencies are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>infinispan-client-hotrod</code> adds the <a href="https://infinispan.org/docs/stable/titles/hotrod_java/hotrod_java.html">Java Hot Rod Client</a>.</p>
</li>
<li>
<p><code>infinispan-api</code> adds the Infinispan new API with the annotations.</p>
</li>
<li>
<p><code>infinispan-query-dsl</code> adds the Infinispan Search API.</p>
</li>
<li>
<p><code>infinispan-remote-query-client</code> adds a remote search client.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.infinispan<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>infinispan-client-hotrod<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.infinispan<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>infinispan-api<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.infinispan<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>infinispan-query-dsl<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.infinispan<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>infinispan-remote-query-client<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_remote_connection">Create a Remote Connection</h4>
<div class="paragraph">
<p>Update the <code>connect()</code> method in the <code>DataSourceConnector</code> class as follows:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.db.DataSourceConnector</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">ConfigurationBuilder</span> <span class="tok-n">builder</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ConfigurationBuilder</span><span class="tok-p">();</span> <i class="conum" data-value="1"></i><b>(1)</b>

<span class="tok-n">builder</span><span class="tok-p">.</span><span class="tok-na">uri</span><span class="tok-p">(</span><span class="tok-s">&quot;hotrod://admin:secret@localhost:11222&quot;</span><span class="tok-p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>

<span class="tok-n">builder</span><span class="tok-p">.</span><span class="tok-na">clientIntelligence</span><span class="tok-p">(</span><span class="tok-n">ClientIntelligence</span><span class="tok-p">.</span><span class="tok-na">BASIC</span><span class="tok-p">);</span> <i class="conum" data-value="3"></i><b>(3)</b>

<span class="tok-n">remoteCacheManager</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">RemoteCacheManager</span><span class="tok-p">(</span><span class="tok-n">builder</span><span class="tok-p">.</span><span class="tok-na">build</span><span class="tok-p">());</span> <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creates a <code>ConfigurationBuilder</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>HotRod URI connection (server, port and credentials)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Uses <code>BASIC</code> Hot Rod client intelligence. This is required to use Docker with a Mac.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Creates a <code>RemoteCacheManager</code> with the configuration.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_test_the_connection">Test the Connection</h4>
<div class="paragraph">
<p>Run <code>HealthChecker</code> to make sure your connection is successful.</p>
</div>
<div class="paragraph">
<p>You should see the following messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>
---- Connect to Infinispan ----
INFO: ISPN004021: Infinispan version: Infinispan ...
---- Connection count: <span class="tok-m">1</span> ----
---- Shutdown the client ----</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_temperature_loader">Implementing Temperature Loader</h3>
<div class="paragraph">
<p>In this section of the tutorial, you implement the Temperature Loader application and learn how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create caches from the Console.</p>
</li>
<li>
<p>Read data from the cache.</p>
</li>
<li>
<p>Write data to the cache.</p>
</li>
<li>
<p>Expire entries in the cache.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_create_a_temperature_cache">Create a Temperature Cache</h4>
<div class="paragraph">
<p>Update the <code>connect()</code> method in the <code>DataSourceConnector</code> class by adding a <code>remoteCache("temperature")</code> as follows:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.db.DataSourceConnector</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">builder</span><span class="tok-p">.</span><span class="tok-na">remoteCache</span><span class="tok-p">(</span><span class="tok-s">&quot;temperature&quot;</span><span class="tok-p">).</span><span class="tok-na">configurationURI</span><span class="tok-p">(</span><span class="tok-n">temperatureCacheConfig</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Adds a cache named <code>temperature</code> that uses the content of the 'temperatureCacheConfig.xml' file.
<div class="paragraph">
<p>This configuration uses Protobuf encoding for keys and values so that you can operate on data from different clients.</p>
</div></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>View the configuration in JSON for the cache from the Console once it&#8217;s created.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_put_and_read_temperature_data">Put and Read Temperature Data</h4>
<div class="paragraph">
<p>Implement the <code>getForLocation()</code> method in the <code>TemperatureLoader</code> service as follows:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.temperature.TemperatureLoader</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>   <span class="tok-nd">@Override</span>
   <span class="tok-kd">public</span> <span class="tok-n">Float</span> <span class="tok-nf">getForLocation</span><span class="tok-p">(</span><span class="tok-n">String</span> <span class="tok-n">location</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-n">Float</span> <span class="tok-n">temperature</span> <span class="tok-o">=</span> <span class="tok-n">cache</span><span class="tok-p">.</span><span class="tok-na">get</span><span class="tok-p">(</span><span class="tok-n">location</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-n">temperature</span> <span class="tok-o">==</span> <span class="tok-kc">null</span><span class="tok-p">)</span> <span class="tok-p">{</span>
         <span class="tok-n">temperature</span> <span class="tok-o">=</span> <span class="tok-n">fetchTemperature</span><span class="tok-p">();</span> <i class="conum" data-value="2"></i><b>(2)</b>
         <span class="tok-n">cache</span><span class="tok-p">.</span><span class="tok-na">put</span><span class="tok-p">(</span><span class="tok-n">location</span><span class="tok-p">,</span> <span class="tok-n">temperature</span><span class="tok-p">);</span> <i class="conum" data-value="3"></i><b>(3)</b>
      <span class="tok-p">}</span>
      <span class="tok-k">return</span> <span class="tok-n">temperature</span><span class="tok-p">;</span>
   <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Get the value for the <code>location</code> key.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Fetches the value if it does not exist in the cache.
<div class="paragraph">
<p>The private <code>fetchTemperature()</code> method emulates an external service call that takes 200ms to retrieve the temperature for a geographic location.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Adds the value to the <code>temperature</code> cache.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_verify_temperature_loader">Verify Temperature Loader</h4>
<div class="paragraph">
<p>Run <code>TemperatureLoaderApp</code> to check that it adds temperature data.</p>
</div>
<div class="paragraph">
<p>The first time the application runs, it takes about two seconds to load data. Subsequent calls retrieve the temperature from the cache, which increases performance.</p>
</div>
<div class="paragraph">
<p>You should see messages such as the following:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.client.temperature.TemperatureLoaderApp</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>
<span class="tok-o">----</span> <span class="tok-n">Connect</span> <span class="tok-n">to</span> <span class="tok-n">Infinispan</span> <span class="tok-o">----</span>
<span class="tok-o">&lt;</span><span class="tok-n">timestamp</span><span class="tok-o">&gt;</span> <span class="tok-n">org</span><span class="tok-p">.</span><span class="tok-na">infinispan</span><span class="tok-p">.</span><span class="tok-na">client</span><span class="tok-p">.</span><span class="tok-na">hotrod</span><span class="tok-p">.</span><span class="tok-na">RemoteCacheManager</span> <span class="tok-n">actualStart</span>
<span class="tok-nl">INFO:</span> <span class="tok-n">ISPN004021</span><span class="tok-p">:</span> <span class="tok-n">Infinispan</span> <span class="tok-n">version</span><span class="tok-p">:</span> <span class="tok-n">Infinispan</span> <span class="tok-err">&#39;</span><span class="tok-n">Corona</span> <span class="tok-n">Extra</span><span class="tok-err">&#39;</span> <span class="tok-mf">11.0.1</span><span class="tok-p">.</span><span class="tok-na">Final</span>
<span class="tok-o">----</span> <span class="tok-n">Get</span> <span class="tok-n">or</span> <span class="tok-n">create</span> <span class="tok-n">the</span> <span class="tok-err">&#39;</span><span class="tok-n">temperature</span><span class="tok-err">&#39;</span> <span class="tok-n">cache</span> <span class="tok-o">----</span>
<span class="tok-o">----</span> <span class="tok-n">Press</span> <span class="tok-n">any</span> <span class="tok-n">key</span> <span class="tok-n">to</span> <span class="tok-n">quit</span> <span class="tok-o">----</span>
<span class="tok-o">----</span> <span class="tok-n">Loading</span> <span class="tok-n">information</span> <span class="tok-o">----</span>
<span class="tok-n">Rome</span><span class="tok-p">,</span> <span class="tok-n">Italy</span> <span class="tok-o">-</span> <span class="tok-mf">22.000622</span>
<span class="tok-n">Como</span><span class="tok-p">,</span> <span class="tok-n">Italy</span> <span class="tok-o">-</span> <span class="tok-mf">21.044369</span>
<span class="tok-p">...</span>

<span class="tok-o">----</span> <span class="tok-n">Loaded</span> <span class="tok-n">in</span> <span class="tok-mi">1762</span><span class="tok-n">ms</span> <span class="tok-o">----</span>
<span class="tok-o">----</span> <span class="tok-n">Loading</span> <span class="tok-n">information</span> <span class="tok-o">----</span>
<span class="tok-n">Rome</span><span class="tok-p">,</span> <span class="tok-n">Italy</span> <span class="tok-o">-</span> <span class="tok-mf">22.000622</span>
<span class="tok-n">Como</span><span class="tok-p">,</span> <span class="tok-n">Italy</span> <span class="tok-o">-</span> <span class="tok-mf">21.044369</span>
<span class="tok-p">...</span>
<span class="tok-o">----</span> <span class="tok-n">Loaded</span> <span class="tok-n">in</span> <span class="tok-mi">44</span><span class="tok-n">ms</span> <span class="tok-o">----</span>
<span class="tok-n">q</span>
<span class="tok-o">----</span> <span class="tok-n">Shutdown</span> <span class="tok-n">the</span> <span class="tok-n">client</span> <span class="tok-o">----</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_expiring_data">Expiring Data</h4>
<div class="paragraph">
<p>At this point, data in the cache remains the same, even if temperatures at the locations change. You can use expiration to remove data after a period of time so that the Temperature Loader fetches new data for the <code>temperature</code> cache.</p>
</div>
<div class="paragraph">
<p>Update the <code>put()</code> method in the <code>TemperatureLoader</code> class so data expires after 20 seconds as follows:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.temperature.TemperatureLoader</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>   <span class="tok-n">cache</span><span class="tok-p">.</span><span class="tok-na">put</span><span class="tok-p">(</span><span class="tok-n">location</span><span class="tok-p">,</span> <span class="tok-n">temperature</span><span class="tok-p">,</span> <span class="tok-mi">20</span><span class="tok-p">,</span> <span class="tok-n">TimeUnit</span><span class="tok-p">.</span><span class="tok-na">SECONDS</span><span class="tok-p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the <code>TemperatureLoaderApp</code> class again. After 20 seconds you should notice that temperature loading performance decreases because the service needs to fetch data again.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_temperature_monitor">Implementing Temperature Monitor</h3>
<div class="paragraph">
<p>In this section of the tutorial, you implement the Temperature Monitor application and learn how to use <a href="https://infinispan.org/docs/stable/titles/hotrod_java/hotrod_java.html#creating_event_listeners">Infinispan Client Listeners</a>.</p>
</div>
<div class="paragraph">
<p>These client listeners enable the Temperator Monitor application to display notifications about temperature changes that happen for each location.</p>
</div>
<div class="sect3">
<h4 id="_create_a_client_listener">Create a Client Listener</h4>
<div class="paragraph">
<p>At present, client listeners do not include values of keys in receiving events. For this reason, you use the Async API to get the value and display the temperature that corresponds to the key.</p>
</div>
<div class="paragraph">
<p>Update the <code>TemperatureMonitor</code> service as follows:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.TemperatureMonitor</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>    <span class="tok-nd">@ClientListener</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">TemperatureChangesListener</span> <span class="tok-p">{</span>
      <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">location</span><span class="tok-p">;</span>

      <span class="tok-n">TemperatureChangesListener</span><span class="tok-p">(</span><span class="tok-n">String</span> <span class="tok-n">location</span><span class="tok-p">)</span> <span class="tok-p">{</span>
         <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-na">location</span> <span class="tok-o">=</span> <span class="tok-n">location</span><span class="tok-p">;</span>
      <span class="tok-p">}</span>

      <span class="tok-nd">@ClientCacheEntryCreated</span> <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">created</span><span class="tok-p">(</span><span class="tok-n">ClientCacheEntryCreatedEvent</span> <span class="tok-n">event</span><span class="tok-p">)</span> <span class="tok-p">{</span>
         <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">.</span><span class="tok-na">getKey</span><span class="tok-p">().</span><span class="tok-na">equals</span><span class="tok-p">(</span><span class="tok-n">location</span><span class="tok-p">))</span> <span class="tok-p">{</span>
            <span class="tok-n">cache</span><span class="tok-p">.</span><span class="tok-na">getAsync</span><span class="tok-p">(</span><span class="tok-n">location</span><span class="tok-p">)</span> <i class="conum" data-value="3"></i><b>(3)</b>
                  <span class="tok-p">.</span><span class="tok-na">whenComplete</span><span class="tok-p">((</span><span class="tok-n">temperature</span><span class="tok-p">,</span> <span class="tok-n">ex</span><span class="tok-p">)</span> <span class="tok-o">-&gt;</span>
                  <span class="tok-n">System</span><span class="tok-p">.</span><span class="tok-na">out</span><span class="tok-p">.</span><span class="tok-na">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;&gt;&gt; Location %s Temperature %s&quot;</span><span class="tok-p">,</span> <span class="tok-n">location</span><span class="tok-p">,</span> <span class="tok-n">temperature</span><span class="tok-p">));</span>
         <span class="tok-p">}</span>
      <span class="tok-p">}</span>
    <span class="tok-p">}</span>

   <span class="tok-p">...</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">monitorLocation</span><span class="tok-p">(</span><span class="tok-n">String</span> <span class="tok-n">location</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-n">System</span><span class="tok-p">.</span><span class="tok-na">out</span><span class="tok-p">.</span><span class="tok-na">println</span><span class="tok-p">(</span><span class="tok-s">&quot;---- Start monitoring temperature changes for &quot;</span> <span class="tok-o">+</span> <span class="tok-n">location</span> <span class="tok-o">+</span> <span class="tok-s">&quot; ----\n&quot;</span><span class="tok-p">);</span>
        <span class="tok-n">TemperatureChangesListener</span> <span class="tok-n">temperatureChangesListener</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">TemperatureChangesListener</span><span class="tok-p">(</span><span class="tok-n">location</span><span class="tok-p">);</span>
        <span class="tok-n">cache</span><span class="tok-p">.</span><span class="tok-na">addClientListener</span><span class="tok-p">(</span><span class="tok-n">temperatureChangesListener</span><span class="tok-p">);</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotates <code>TemperatureChangesListener</code> with <code>@ClientListener</code> to make it an Infinispan Client Listener.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Uses the <code>@ClientCacheEntryCreated</code> annotation to get notifications every time data is added to the <code>temperature</code> cache.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Filters locations by key and gets values using the async call and then prints the new values.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Adds the client listener to the cache.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The preceding example filters events in the listener. However, these events can also be filtered server-side with an <a href="https://infinispan.org/docs/stable/titles/hotrod_java/hotrod_java.html#filtering_events">event filter</a>. However, you must create the filter and deploy it to Infinispan Server, which is beyond the scope of this tutorial.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Always remove client listeners from caches when you no longer need them.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_verify_temperature_monitor">Verify Temperature Monitor</h4>
<div class="paragraph">
<p>Make sure that <code>TemperatureLoaderApp</code> is running and then run <code>TemperatureMonitorApp</code>.</p>
</div>
<div class="paragraph">
<p>You should see a message that displays the current temperature of a location and then get notifications for new temperatures every 20 seconds.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.client.temperature.TemperatureMonitorApp</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>
---- Connect to Infinispan ----
&lt;timestamp&gt; org.infinispan.client.hotrod.RemoteCacheManager actualStart
INFO: ISPN004021: Infinispan version: Infinispan <span class="tok-s1">&#39;Corona Extra&#39;</span> <span class="tok-m">11</span>.0.1.Final
---- Get or create the <span class="tok-s1">&#39;temperature&#39;</span> cache ----
Temperature <span class="tok-m">14</span>.185611 <span class="tok-k">for</span> Bilbao, Spain
---- Start monitoring temperature changes <span class="tok-k">for</span> Bilbao, Spain ----
---- Press any key to quit ----
&gt;&gt; Location Bilbao, Spain Temperature <span class="tok-m">7</span>.374308
&gt;&gt; Location Bilbao, Spain Temperature <span class="tok-m">24</span>.784744</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Change the expiration values to get more notifications. Use <code>@ClientCacheEntryExpired</code> to get notifications when data expires.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_weather_loader">Implementing Weather Loader</h3>
<div class="paragraph">
<p>In this section of the tutorial, you implement the Weather Loader application and learn how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add complex key/value entries to a cache.</p>
</li>
<li>
<p>Serialize Java objects so they can be transmitted to Infinispan Server.</p>
</li>
<li>
<p>Use <a href="https://developers.google.com/protocol-buffers">Protobuf</a> encoding for searchable data so you perform remote queries from Hot Rod Java clients as well as REST clients and other Hot Rod clients such as C# and Node.js.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_annotate_the_locationweather_pojo">Annotate the LocationWeather POJO</h4>
<div class="paragraph">
<p>Infinispan uses <a href="https://github.com/infinispan/protostream">Protostream</a> to serialize data to byte.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>@ProtoField</code> annotation to <code>LocationWeather</code> as follows:</p>
</li>
<li>
<p>Add indexing annotations as follows</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.data.LocationWeather</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>    <span class="tok-nd">@Indexed</span>
    <span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">LocationWeather</span> <span class="tok-p">{</span>

       <span class="tok-nd">@Basic</span>
       <span class="tok-nd">@ProtoField</span><span class="tok-p">(</span><span class="tok-n">number</span> <span class="tok-o">=</span> <span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-n">defaultValue</span> <span class="tok-o">=</span> <span class="tok-s">&quot;0.0&quot;</span><span class="tok-p">)</span>
       <span class="tok-kt">float</span> <span class="tok-n">temperature</span><span class="tok-p">;</span>

       <span class="tok-nd">@Basic</span>
       <span class="tok-nd">@ProtoField</span><span class="tok-p">(</span><span class="tok-n">number</span> <span class="tok-o">=</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
       <span class="tok-n">String</span> <span class="tok-n">condition</span><span class="tok-p">;</span>

       <span class="tok-nd">@Keyword</span><span class="tok-p">(</span><span class="tok-n">projectable</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-n">sortable</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-n">normalizer</span> <span class="tok-o">=</span> <span class="tok-s">&quot;lowercase&quot;</span><span class="tok-p">,</span> <span class="tok-n">indexNullAs</span> <span class="tok-o">=</span> <span class="tok-s">&quot;unnamed&quot;</span><span class="tok-p">,</span> <span class="tok-n">norms</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-p">)</span>
       <span class="tok-nd">@ProtoField</span><span class="tok-p">(</span><span class="tok-n">number</span> <span class="tok-o">=</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
       <span class="tok-n">String</span> <span class="tok-n">city</span><span class="tok-p">;</span>

       <span class="tok-nd">@Keyword</span><span class="tok-p">(</span><span class="tok-n">projectable</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-n">sortable</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-n">normalizer</span> <span class="tok-o">=</span> <span class="tok-s">&quot;lowercase&quot;</span><span class="tok-p">,</span> <span class="tok-n">indexNullAs</span> <span class="tok-o">=</span> <span class="tok-s">&quot;unnamed&quot;</span><span class="tok-p">,</span> <span class="tok-n">norms</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-p">)</span>
       <span class="tok-nd">@ProtoField</span><span class="tok-p">(</span><span class="tok-n">number</span> <span class="tok-o">=</span> <span class="tok-mi">4</span><span class="tok-p">)</span>
       <span class="tok-n">String</span> <span class="tok-n">country</span><span class="tok-p">;</span>
<span class="tok-p">...</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_the_serialization_context">Configure the Serialization Context</h4>
<div class="paragraph">
<p>To marshall the annotated <code>LocationWeather</code> class, Infinispan requires a Protobuf schema. You can either provide a Protobuf descriptor file or create a descriptor file from the annotations you added to the POJO.</p>
</div>
<div class="paragraph">
<p>In <code>LocationWeatherMarshallingContext</code>, you add the schema to the Protobuf cache in Infinispan and then build a Protobuf using the <code>@AutoProtoSchemaBuilder</code> method.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.db.LocationWeatherMarshallingContext</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-nd">@AutoProtoSchemaBuilder</span><span class="tok-p">(</span>
<span class="tok-n">includeClasses</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
<span class="tok-n">LocationWeather</span><span class="tok-p">.</span><span class="tok-na">class</span>
<span class="tok-p">},</span>
<span class="tok-n">schemaFileName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;weather.proto&quot;</span><span class="tok-p">,</span>
<span class="tok-n">schemaFilePath</span> <span class="tok-o">=</span> <span class="tok-s">&quot;proto/&quot;</span><span class="tok-p">,</span>
<span class="tok-n">schemaPackageName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;org.infinispan.tutorial.data&quot;</span><span class="tok-p">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">LocationWeatherSchema</span> <span class="tok-kd">extends</span> <span class="tok-n">GeneratedSchema</span> <span class="tok-p">{</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Run <code>mvn clean package</code> from the command line or build the project in your IDE to generate the <code>LocationWeatherSchemaImpl</code> class.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.db.LocationWeatherMarshallingContext</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>       <span class="tok-c1">// Retrieve metadata cache</span>
      <span class="tok-n">RemoteCache</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-p">,</span> <span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">metadataCache</span> <span class="tok-o">=</span>
            <span class="tok-n">cacheManager</span><span class="tok-p">.</span><span class="tok-na">getCache</span><span class="tok-p">(</span><span class="tok-n">ProtobufMetadataManagerConstants</span><span class="tok-p">.</span><span class="tok-na">PROTOBUF_METADATA_CACHE_NAME</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b>

      <span class="tok-n">GeneratedSchema</span> <span class="tok-n">schema</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">LocationWeatherSchemaImpl</span><span class="tok-p">();</span> <i class="conum" data-value="2"></i><b>(2)</b>

      <span class="tok-c1">// Define the new schema on the server too</span>
      <span class="tok-n">metadataCache</span><span class="tok-p">.</span><span class="tok-na">put</span><span class="tok-p">(</span><span class="tok-n">schema</span><span class="tok-p">.</span><span class="tok-na">getProtoFileName</span><span class="tok-p">(),</span> <span class="tok-n">schema</span><span class="tok-p">.</span><span class="tok-na">getProtoFile</span><span class="tok-p">());</span> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Retrieves the metadata cache that stores all Protobuf schemas.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use the class generated from the <code>LocationWeatherSchema</code> interface to retrieve the schema.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Adds the schema to the cache.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_weather_cache">Create a Weather Cache</h4>
<div class="paragraph">
<p>In this step, you create a <code>weather</code> cache that can store <code>LocationWeather</code> objects. First you must initialize the marshalling context in the application and then create the cache, as follows:</p>
</div>
<div class="paragraph">
<p>As before, configure the <code>weather</code> cache.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.db.DataSourceConnector</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">builder</span><span class="tok-p">.</span><span class="tok-na">remoteCache</span><span class="tok-p">(</span><span class="tok-s">&quot;weather&quot;</span><span class="tok-p">).</span><span class="tok-na">configurationURI</span><span class="tok-p">(</span><span class="tok-n">weatherCacheConfig</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Adds a cache named <code>weather</code> that uses the content of the 'weatherCacheConfig.xml' file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unlike the <code>temperature</code> cache, the <code>weather</code> cache stores complex Java objects and you will query
the values. For this reason the serialization context needs to be registered on the client
and on Infinispan Server.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.db.DataSourceConnector</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-o">=</span>     <span class="tok-kd">public</span> <span class="tok-n">RemoteCache</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-p">,</span> <span class="tok-n">LocationWeather</span><span class="tok-o">&gt;</span> <span class="tok-nf">getWeatherCache</span><span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-n">System</span><span class="tok-p">.</span><span class="tok-na">out</span><span class="tok-p">.</span><span class="tok-na">println</span><span class="tok-p">(</span><span class="tok-s">&quot;--- Get or Create a queryable weather cache ---&quot;</span><span class="tok-p">);</span>
        <span class="tok-n">Objects</span><span class="tok-p">.</span><span class="tok-na">requireNonNull</span><span class="tok-p">(</span><span class="tok-n">remoteCacheManager</span><span class="tok-p">);</span>

        <span class="tok-n">LocationWeatherMarshallingContext</span><span class="tok-p">.</span><span class="tok-na">initSerializationContext</span><span class="tok-p">(</span><span class="tok-n">remoteCacheManager</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="tok-k">return</span> <span class="tok-n">remoteCacheManager</span><span class="tok-p">.</span><span class="tok-na">getCache</span><span class="tok-p">(</span><span class="tok-s">&quot;weather&quot;</span><span class="tok-p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Initializes the serialization context.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Gets the <code>weather</code> cache.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_verify_weather_loader">Verify Weather Loader</h4>
<div class="paragraph">
<p>The code that loads data into the <code>weather</code> cache is located in the <code>org.infinispan.tutorial.services.weather.FullWeatherLoader</code>. Because this service is similar to the code you implemented for the <code>TemperatureLoader</code> service, you don&#8217;t need to do anything else.</p>
</div>
<div class="paragraph">
<p>Run <code>WeatherLoaderApp</code> to check that it loads weather data.</p>
</div>
<div class="paragraph">
<p>You should see messages that indicate the <code>weather</code> cache is created and weather information is added for different locations:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.client.weather.WeatherLoaderApp</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>
---- Connect to Infinispan ----
&lt;timestamp&gt; org.infinispan.client.hotrod.RemoteCacheManager actualStart
INFO: ISPN004021: Infinispan version: Infinispan <span class="tok-s1">&#39;Corona Extra&#39;</span> <span class="tok-m">11</span>.0.1.Final
LocationWeatherMarshallingContext - initialize the serialization context <span class="tok-k">for</span> LocationWeather class
---- Get or create the <span class="tok-s1">&#39;weather&#39;</span> cache ----
---- Press any key to quit ----

---- Loading information ----
Rome, Italy - LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">17</span>.252243, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;SUNNY&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Rome&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Italy&#39;</span><span class="tok-o">}</span>
Como, Italy - LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">24</span>.495003, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;WINDLESS&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Como&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Italy&#39;</span><span class="tok-o">}</span>
Basel, Switzerland - LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">19</span>.795946, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;WINDLESS&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Basel&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Switzerland&#39;</span><span class="tok-o">}</span>
Bern, Switzerland - LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">20</span>.455978, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;WINDLESS&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Bern&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Switzerland&#39;</span><span class="tok-o">}</span>
...
---- Loaded <span class="tok-k">in</span> 3386ms ----

---- Loading information ----
Rome, Italy - LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">17</span>.252243, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;CLOUDY&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Rome&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Italy&#39;</span><span class="tok-o">}</span>
Como, Italy - LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">24</span>.495003, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;PARTIALLY_COVERED&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Como&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Italy&#39;</span><span class="tok-o">}</span>
...
---- Loaded <span class="tok-k">in</span> 70ms ----</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_weather_finder">Implementing Weather Finder</h3>
<div class="paragraph">
<p>In this section of the tutorial, you learn how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create and run FROM queries.</p>
</li>
<li>
<p>Create and run SELECT queries.</p>
</li>
<li>
<p>Perform continuous queries.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_create_a_from_query">Create a FROM Query</h4>
<div class="paragraph">
<p>Create a FROM query on values in the <code>weather</code> cache as follows:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.weather.WeatherSearch</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>   <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">LocationWeather</span><span class="tok-o">&gt;</span> <span class="tok-nf">findByCountry</span><span class="tok-p">(</span><span class="tok-n">String</span> <span class="tok-n">country</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-n">QueryFactory</span> <span class="tok-n">queryFactory</span> <span class="tok-o">=</span> <span class="tok-n">Search</span><span class="tok-p">.</span><span class="tok-na">getQueryFactory</span><span class="tok-p">(</span><span class="tok-n">weather</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b>

      <span class="tok-n">Query</span><span class="tok-o">&lt;</span><span class="tok-n">LocationWeather</span><span class="tok-o">&gt;</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">queryFactory</span><span class="tok-p">.</span><span class="tok-na">create</span><span class="tok-p">(</span><span class="tok-s">&quot;FROM org.infinispan.tutorial.data.LocationWeather WHERE country = :country&quot;</span><span class="tok-p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>

      <span class="tok-n">query</span><span class="tok-p">.</span><span class="tok-na">setParameter</span><span class="tok-p">(</span><span class="tok-s">&quot;country&quot;</span><span class="tok-p">,</span> <span class="tok-n">country</span><span class="tok-p">);</span> <i class="conum" data-value="3"></i><b>(3)</b>

      <span class="tok-k">return</span> <span class="tok-n">query</span><span class="tok-p">.</span><span class="tok-na">execute</span><span class="tok-p">().</span><span class="tok-na">list</span><span class="tok-p">();</span> <i class="conum" data-value="4"></i><b>(4)</b>
   <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Gets the <code>QueryFactory</code> from the cache.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Creates a FROM query using the Ickle query language. This query finds each <code>LocationWeather</code> in a country.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Sets the <code>country</code> parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Executes the query and returns the list.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_run_the_from_query">Run the FROM Query</h4>
<div class="paragraph">
<p>Make sure <code>WeatherLoaderApp</code> is running and then run <code>WeatherFinderApp</code>.</p>
</div>
<div class="paragraph">
<p>You should see output such as the following:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.client.weather.WeatherFinderApp</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>---- Get or create the <span class="tok-s1">&#39;weather&#39;</span> cache ----
Spain: <span class="tok-o">[</span>LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">6</span>.2846804, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;CLOUDY&#39;</span>,city<span class="tok-o">=</span><span class="tok-s1">&#39;Bilbao&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Spain&#39;</span><span class="tok-o">}</span>,
LocationWeather<span class="tok-o">{</span><span class="tok-nv">temperature</span><span class="tok-o">=</span><span class="tok-m">18</span>.044653, <span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-s1">&#39;SUNNY&#39;</span>, <span class="tok-nv">city</span><span class="tok-o">=</span><span class="tok-s1">&#39;Madrid&#39;</span>, <span class="tok-nv">country</span><span class="tok-o">=</span><span class="tok-s1">&#39;Spain&#39;</span><span class="tok-o">}]</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_select_query">Create a SELECT Query</h4>
<div class="paragraph">
<p>For some queries, you don&#8217;t want every field for an object. In this example, you create and run a query that returns only the <code>city</code> that matches a given weather condition.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.weather.WeatherSearch</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">findByCondition</span><span class="tok-p">(</span><span class="tok-n">WeatherCondition</span> <span class="tok-n">condition</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-n">Query</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">[]&gt;</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">createFindLocationWeatherByConditionQuery</span><span class="tok-p">(</span><span class="tok-n">condition</span><span class="tok-p">);</span>
      <span class="tok-k">return</span> <span class="tok-n">query</span><span class="tok-p">.</span><span class="tok-na">execute</span><span class="tok-p">().</span><span class="tok-na">list</span><span class="tok-p">().</span><span class="tok-na">stream</span><span class="tok-p">().</span><span class="tok-na">map</span><span class="tok-p">(</span><span class="tok-n">data</span> <span class="tok-o">-&gt;</span> <span class="tok-p">(</span><span class="tok-n">String</span><span class="tok-p">)</span> <span class="tok-n">data</span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">]</span><span class="tok-p">).</span><span class="tok-na">collect</span><span class="tok-p">(</span><span class="tok-n">Collectors</span><span class="tok-p">.</span><span class="tok-na">toList</span><span class="tok-p">());</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="tok-p">}</span>

    <span class="tok-kd">private</span> <span class="tok-n">Query</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">[]&gt;</span> <span class="tok-nf">createFindLocationWeatherByConditionQuery</span><span class="tok-p">(</span><span class="tok-n">WeatherCondition</span> <span class="tok-n">condition</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-n">QueryFactory</span> <span class="tok-n">queryFactory</span> <span class="tok-o">=</span> <span class="tok-n">Search</span><span class="tok-p">.</span><span class="tok-na">getQueryFactory</span><span class="tok-p">(</span><span class="tok-n">weather</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b>

      <span class="tok-n">Query</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">[]&gt;</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">queryFactory</span><span class="tok-p">.</span><span class="tok-na">create</span><span class="tok-p">(</span><span class="tok-s">&quot;SELECT city FROM org.infinispan.tutorial.data.LocationWeather w where w.condition = :condition&quot;</span><span class="tok-p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>

      <span class="tok-n">query</span><span class="tok-p">.</span><span class="tok-na">setParameter</span><span class="tok-p">(</span><span class="tok-s">&quot;condition&quot;</span><span class="tok-p">,</span> <span class="tok-n">condition</span><span class="tok-p">.</span><span class="tok-na">name</span><span class="tok-p">());</span> <i class="conum" data-value="3"></i><b>(3)</b>

      <span class="tok-k">return</span> <span class="tok-n">query</span><span class="tok-p">;</span>
   <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Gets the <code>QueryFactory</code> from the cache.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Creates a SELECT query using the Ickle query language. This query finds every <code>LocationWeather</code> with a weather condition and returns only the city.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Sets the <code>condition</code> parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Executes the query, returns the list, and filters the <code>Object[]</code> to get the <code>String</code> results.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_run_the_select_query">Run the SELECT Query</h4>
<div class="paragraph">
<p>Make sure <code>WeatherLoaderApp</code> is running and then run <code>WeatherFinderApp</code>.</p>
</div>
<div class="paragraph">
<p>You should see output such as the following:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.client.weather.WeatherFinderApp</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>SUNNY: <span class="tok-o">[</span>Madrid<span class="tok-o">]</span>
CLOUDY: <span class="tok-o">[</span>Lisbon, Bilbao, Newcastle, Como<span class="tok-o">]</span>
RAINY: <span class="tok-o">[</span>Cluj-Napoca<span class="tok-o">]</span>
PARTIALLY_COVERED: <span class="tok-o">[</span>Toronto, Bern<span class="tok-o">]</span>
HUMID: <span class="tok-o">[]</span>
WINDY: <span class="tok-o">[]</span>
FOGGY: <span class="tok-o">[</span>Washington, Porto, Rome<span class="tok-o">]</span>
WINDLESS: <span class="tok-o">[</span>London, Raleigh<span class="tok-o">]</span>
DRY: <span class="tok-o">[</span>Ottawa<span class="tok-o">]</span>
WET: <span class="tok-o">[</span>Basel, Bucarest<span class="tok-o">]</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_continuous_query">Create a Continuous Query</h4>
<div class="paragraph">
<p><a href="https://infinispan.org/docs/stable/titles/developing/developing.html#query_continuous">Continuous Queries</a> allow applications to register listeners that receive the entries matching a query filter. In this way, applications are continuously notified of changes to the queried data set.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.weather.WeatherSearch</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">findWeatherByConditionContinuously</span><span class="tok-p">(</span><span class="tok-n">WeatherCondition</span> <span class="tok-n">condition</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-n">Query</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">[]&gt;</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">createFindLocationWeatherByConditionQuery</span><span class="tok-p">(</span><span class="tok-n">condition</span><span class="tok-p">);</span> <i class="conum" data-value="1"></i><b>(1)</b>

      <span class="tok-n">ContinuousQuery</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-p">,</span> <span class="tok-n">LocationWeather</span><span class="tok-o">&gt;</span> <span class="tok-n">continuousQuery</span> <span class="tok-o">=</span> <span class="tok-n">Search</span><span class="tok-p">.</span><span class="tok-na">getContinuousQuery</span><span class="tok-p">(</span><span class="tok-n">weather</span><span class="tok-p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>

      <span class="tok-n">ContinuousQueryListener</span><span class="tok-o">&lt;&gt;</span> <span class="tok-n">listener</span> <span class="tok-o">=</span>
            <span class="tok-k">new</span> <span class="tok-n">ContinuousQueryListener</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-p">,</span> <span class="tok-n">Object</span><span class="tok-o">[]&gt;</span><span class="tok-p">()</span> <span class="tok-p">{</span> <i class="conum" data-value="3"></i><b>(3)</b>
               <span class="tok-nd">@Override</span>
               <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">resultJoining</span><span class="tok-p">(</span><span class="tok-n">String</span> <span class="tok-n">key</span><span class="tok-p">,</span> <span class="tok-n">Object</span><span class="tok-o">[]</span> <span class="tok-n">data</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                   <span class="tok-n">System</span><span class="tok-p">.</span><span class="tok-na">out</span><span class="tok-p">.</span><span class="tok-na">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;%s is now %s%n&quot;</span><span class="tok-p">,</span> <span class="tok-n">data</span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">]</span><span class="tok-p">,</span> <span class="tok-n">condition</span><span class="tok-p">);</span>
               <span class="tok-p">}</span>
            <span class="tok-p">};</span>

      <span class="tok-n">continuousQuery</span><span class="tok-p">.</span><span class="tok-na">addContinuousQueryListener</span><span class="tok-p">(</span><span class="tok-n">query</span><span class="tok-p">,</span> <span class="tok-n">listener</span><span class="tok-p">);</span> <i class="conum" data-value="4"></i><b>(4)</b>
   <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creates a query that finds all locations with a certain weather condition; for example, 'Sunny'.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Creates a continuous query on the <code>weather</code> cache.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Creates a continuous query listener and prints the condition.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Matches the query and the listener in the <code>ContinuousQuery</code> object</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Always remove continuous queries when you no longer need them.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_run_the_continuous_query">Run the Continuous Query</h4>
<div class="paragraph">
<p>Make sure <code>WeatherLoaderApp</code> is running and then run <code>WeatherFinderApp</code>.</p>
</div>
<div class="paragraph">
<p>You should see output such as the following:</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.client.weather.WeatherFinderApp</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>---- Press any key to quit ----
Madrid is now SUNNY
Bilbao is now SUNNY
Toronto is now SUNNY
Newcastle is now SUNNY
Cluj-Napoca is now SUNNY
Porto is now SUNNY
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_infinispan_server">Testing Infinispan Server</h3>
<div class="paragraph">
<p><a href="https://www.testcontainers.org/test_framework_integration/junit_5/">Test containers</a> are a great way to run an Infinispan Server and test with a <a href="https://junit.org/junit5/">Junit 5</a> extension.</p>
</div>
<div class="paragraph">
<p>This section of the tutorial provides an example test that verifies the temperatures loaded in Infinispan Server are correct.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>You need <a href="https://www.docker.com/">Docker</a> for this part of the tutorial.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_dependencies_2">Add Dependencies</h4>
<div class="paragraph">
<p>Open the <code>pom.xml</code> file for this project and add the <code>infinispan-server-testdriver-junit5</code> dependency as follows:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span></span>    <span class="tok-nt">&lt;dependency&gt;</span>
        <span class="tok-nt">&lt;groupId&gt;</span>org.infinispan<span class="tok-nt">&lt;/groupId&gt;</span>
        <span class="tok-nt">&lt;artifactId&gt;</span>infinispan-server-testdriver-junit5<span class="tok-nt">&lt;/artifactId&gt;</span>
        <span class="tok-nt">&lt;version&gt;</span>${version.infinispan}<span class="tok-nt">&lt;/version&gt;</span>
        <span class="tok-nt">&lt;scope&gt;</span>test<span class="tok-nt">&lt;/scope&gt;</span>
    <span class="tok-nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JUnit 4 rules are also available for out-of-the-box testing with Infinispan Server. Check the <code>infinispan-server-testdriver-junit4</code> dependency.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_test_containers">Using Test Containers</h4>
<div class="paragraph">
<p>Create a Junit 5 Test and use the <code>InfinispanServerExtension</code>.</p>
</div>
<div class="listingblock">
<div class="title">org.infinispan.tutorial.services.temperature.TemperatureLoaderTest</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span>
   <span class="tok-nd">@RegisterExtension</span>
   <span class="tok-kd">static</span> <span class="tok-n">InfinispanServerExtension</span> <span class="tok-n">infinispanServerExtension</span> <span class="tok-o">=</span> <span class="tok-n">InfinispanServerExtensionBuilder</span><span class="tok-p">.</span><span class="tok-na">server</span><span class="tok-p">();</span> <i class="conum" data-value="1"></i><b>(1)</b>

   <span class="tok-nd">@Test</span>
   <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">loadLocationTemperature</span><span class="tok-p">()</span> <span class="tok-p">{</span>
      <span class="tok-n">DataSourceConnector</span> <span class="tok-n">dataSourceConnector</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">DataSourceConnector</span><span class="tok-p">(</span><span class="tok-n">createRemoteCacheManager</span><span class="tok-p">());</span>
      <span class="tok-n">TemperatureLoader</span> <span class="tok-n">temperatureLoader</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">TemperatureLoader</span><span class="tok-p">(</span><span class="tok-n">dataSourceConnector</span><span class="tok-p">);</span>
      <span class="tok-n">Float</span> <span class="tok-n">temperatureLoaderForLocation</span> <span class="tok-o">=</span> <span class="tok-n">temperatureLoader</span><span class="tok-p">.</span><span class="tok-na">getForLocation</span><span class="tok-p">(</span><span class="tok-n">WeatherLoader</span><span class="tok-p">.</span><span class="tok-na">LOCATIONS</span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">]</span><span class="tok-p">);</span>
      <span class="tok-n">assertNotNull</span><span class="tok-p">(</span><span class="tok-n">temperatureLoaderForLocation</span><span class="tok-p">);</span>
   <span class="tok-p">}</span>

   <i class="conum" data-value="2"></i><b>(2)</b>
   <span class="tok-kd">private</span> <span class="tok-n">RemoteCacheManager</span> <span class="tok-nf">createRemoteCacheManager</span><span class="tok-p">()</span> <span class="tok-p">{</span>
      <span class="tok-n">RemoteCacheManager</span> <span class="tok-n">remoteCacheManager</span> <span class="tok-o">=</span> <span class="tok-n">infinispanServerExtension</span><span class="tok-p">.</span><span class="tok-na">hotrod</span><span class="tok-p">().</span><span class="tok-na">createRemoteCacheManager</span><span class="tok-p">();</span>
      <span class="tok-n">SerializationContext</span> <span class="tok-n">serCtx</span> <span class="tok-o">=</span> <span class="tok-n">MarshallerUtil</span><span class="tok-p">.</span><span class="tok-na">getSerializationContext</span><span class="tok-p">(</span><span class="tok-n">remoteCacheManager</span><span class="tok-p">);</span>
      <span class="tok-n">LocationWeatherSchema</span> <span class="tok-n">schema</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">LocationWeatherSchemaImpl</span><span class="tok-p">();</span>
      <span class="tok-n">schema</span><span class="tok-p">.</span><span class="tok-na">registerSchema</span><span class="tok-p">(</span><span class="tok-n">serCtx</span><span class="tok-p">);</span>
      <span class="tok-n">schema</span><span class="tok-p">.</span><span class="tok-na">registerMarshallers</span><span class="tok-p">(</span><span class="tok-n">serCtx</span><span class="tok-p">);</span>
      <span class="tok-k">return</span> <span class="tok-n">remoteCacheManager</span><span class="tok-p">;</span>
   <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Registers the Junit 5 Infinispan Server Extension.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Adds a serialization context for the tests.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_next">What&#8217;s Next?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Congratulations on completing this tutorial!</p>
</div>
<div class="paragraph">
<p>You should now be well on your way with using the Infinispan Server. Here are some more things to help you keep learning:</p>
</div>
<div class="paragraph">
<div class="title">Infinispan Integrations</div>
<p><a href="https://quarkus.io/">Quarkus</a>, <a href="https://infinispan.org/infinispan-spring-boot/master/spring_boot_starter.html">Spring Boot</a>, <a href="https://vertx.io/">Vert.x</a> and other frameworks are featured in the <a href="https://github.com/infinispan-demos">Infinispan demos</a>.</p>
</div>
<div class="paragraph">
<div class="title">Kubernetes Operator</div>
<p>Visit the <a href="https://infinispan.org/infinispan-operator/master/operator.html">Infinispan Operator Guide</a> and learn how to deploy and scale Infinispan on <a href="https://kubernetes.io">Kubernetes</a> or <a href="https://www.openshift.com/">OpenShift</a>.</p>
</div>
<div class="paragraph">
<div class="title">Remote Clients</div>
<p>Try the <a href="https://infinispan.org/docs/stable/titles/rest/rest.html">Infinispan REST API</a> and check out different <a href="https://infinispan.org/hotrod-clients/">Hot Rod clients</a> to use Infinispan with other programming languages.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-10-27 17:23:31 +0200
</div>
</div>
</body>
</html>